import{i as ee}from"./index.CKxHyOLG.js";import{v as re}from"./scheduler.DxIB1JCc.js";import{U as J,N as te,P as ne,a as se,b as W,H as oe,p as ae,u as ue,w as ce}from"./parse.C_17_QKy.js";const ie={"<":"\\u003C","\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\u2028":"\\u2028","\u2029":"\\u2029"};class I extends Error{constructor(t,s){super(t),this.name="DevalueError",this.path=s.join("")}}function k(e){return Object(e)!==e}const le=Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Z(e){const t=Object.getPrototypeOf(e);return t===Object.prototype||t===null||Object.getOwnPropertyNames(t).sort().join("\0")===le}function z(e){return Object.prototype.toString.call(e).slice(8,-1)}function fe(e){switch(e){case'"':return'\\"';case"<":return"\\u003C";case"\\":return"\\\\";case`
`:return"\\n";case"\r":return"\\r";case"	":return"\\t";case"\b":return"\\b";case"\f":return"\\f";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return e<" "?`\\u${e.charCodeAt(0).toString(16).padStart(4,"0")}`:""}}function _(e){let t="",s=0;const a=e.length;for(let d=0;d<a;d+=1){const l=e[d],$=fe(l);$&&(t+=e.slice(s,d)+$,s=d+1)}return`"${s===0?e:t+e.slice(s)}"`}function Y(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.getOwnPropertyDescriptor(e,t).enumerable)}const R="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_$",pe=/[<\b\f\n\r\t\0\u2028\u2029]/g,de=/^(?:do|if|in|for|int|let|new|try|var|byte|case|char|else|enum|goto|long|this|void|with|await|break|catch|class|const|final|float|short|super|throw|while|yield|delete|double|export|import|native|return|switch|throws|typeof|boolean|default|extends|finally|package|private|abstract|continue|debugger|function|volatile|interface|protected|transient|implements|instanceof|synchronized)$/;function ye(e,t){const s=new Map,a=[],d=new Map;function l(r){if(typeof r=="function")throw new I("Cannot stringify a function",a);if(!k(r)){if(s.has(r)){s.set(r,s.get(r)+1);return}if(s.set(r,1),t){const n=t(r);if(typeof n=="string"){d.set(r,n);return}}switch(z(r)){case"Number":case"BigInt":case"String":case"Boolean":case"Date":case"RegExp":return;case"Array":r.forEach((n,f)=>{a.push(`[${f}]`),l(n),a.pop()});break;case"Set":Array.from(r).forEach(l);break;case"Map":for(const[n,f]of r)a.push(`.get(${k(n)?T(n):"..."})`),l(f),a.pop();break;default:if(!Z(r))throw new I("Cannot stringify arbitrary non-POJOs",a);if(Y(r).length>0)throw new I("Cannot stringify POJOs with symbolic keys",a);for(const n in r)a.push(`.${n}`),l(r[n]),a.pop()}}}l(e);const $=new Map;Array.from(s).filter(r=>r[1]>1).sort((r,c)=>c[1]-r[1]).forEach((r,c)=>{$.set(r[0],be(c))});function u(r){if($.has(r))return $.get(r);if(k(r))return T(r);if(d.has(r))return d.get(r);const c=z(r);switch(c){case"Number":case"String":case"Boolean":return`Object(${u(r.valueOf())})`;case"RegExp":return`new RegExp(${_(r.source)}, "${r.flags}")`;case"Date":return`new Date(${r.getTime()})`;case"Array":const n=r.map((p,o)=>o in r?u(p):""),f=r.length===0||r.length-1 in r?"":",";return`[${n.join(",")}${f}]`;case"Set":case"Map":return`new ${c}([${Array.from(r).map(u).join(",")}])`;default:const i=`{${Object.keys(r).map(p=>`${me(p)}:${u(r[p])}`).join(",")}}`;return Object.getPrototypeOf(r)===null?Object.keys(r).length>0?`Object.assign(Object.create(null),${i})`:"Object.create(null)":i}}const O=u(e);if($.size){const r=[],c=[],n=[];return $.forEach((f,i)=>{if(r.push(f),d.has(i)){n.push(d.get(i));return}if(k(i)){n.push(T(i));return}switch(z(i)){case"Number":case"String":case"Boolean":n.push(`Object(${u(i.valueOf())})`);break;case"RegExp":n.push(i.toString());break;case"Date":n.push(`new Date(${i.getTime()})`);break;case"Array":n.push(`Array(${i.length})`),i.forEach((p,o)=>{c.push(`${f}[${o}]=${u(p)}`)});break;case"Set":n.push("new Set"),c.push(`${f}.${Array.from(i).map(p=>`add(${u(p)})`).join(".")}`);break;case"Map":n.push("new Map"),c.push(`${f}.${Array.from(i).map(([p,o])=>`set(${u(p)}, ${u(o)})`).join(".")}`);break;default:n.push(Object.getPrototypeOf(i)===null?"Object.create(null)":"{}"),Object.keys(i).forEach(p=>{c.push(`${f}${we(p)}=${u(i[p])}`)})}}),c.push(`return ${O}`),`(function(${r.join(",")}){${c.join(";")}}(${n.join(",")}))`}else return O}function be(e){let t="";do t=R[e%R.length]+t,e=~~(e/R.length)-1;while(e>=0);return de.test(t)?`${t}0`:t}function $e(e){return ie[e]||e}function H(e){return e.replace(pe,$e)}function me(e){return/^[_$a-zA-Z][_$a-zA-Z0-9]*$/.test(e)?e:H(JSON.stringify(e))}function we(e){return/^[_$a-zA-Z][_$a-zA-Z0-9]*$/.test(e)?`.${e}`:`[${H(JSON.stringify(e))}]`}function T(e){if(typeof e=="string")return _(e);if(e===void 0)return"void 0";if(e===0&&1/e<0)return"-0";const t=String(e);return typeof e=="number"?t.replace(/^(-)?0\./,"$1."):typeof e=="bigint"?e+"n":t}function ve(e,t){const s=[],a=new Map,d=[];for(const r in t)d.push({key:r,fn:t[r]});const l=[];let $=0;function u(r){if(typeof r=="function")throw new I("Cannot stringify a function",l);if(a.has(r))return a.get(r);if(r===void 0)return J;if(Number.isNaN(r))return te;if(r===1/0)return ne;if(r===-1/0)return se;if(r===0&&1/r<0)return W;const c=$++;a.set(r,c);for(const{key:f,fn:i}of d){const m=i(r);if(m)return s[c]=`["${f}",${u(m)}]`,c}let n="";if(k(r))n=U(r);else switch(z(r)){case"Number":case"String":case"Boolean":n=`["Object",${U(r)}]`;break;case"BigInt":n=`["BigInt",${r}]`;break;case"Date":n=`["Date","${!isNaN(r.getDate())?r.toISOString():""}"]`;break;case"RegExp":const{source:m,flags:p}=r;n=p?`["RegExp",${_(m)},"${p}"]`:`["RegExp",${_(m)}]`;break;case"Array":n="[";for(let o=0;o<r.length;o+=1)o>0&&(n+=","),o in r?(l.push(`[${o}]`),n+=u(r[o]),l.pop()):n+=oe;n+="]";break;case"Set":n='["Set"';for(const o of r)n+=`,${u(o)}`;n+="]";break;case"Map":n='["Map"';for(const[o,S]of r)l.push(`.get(${k(o)?U(o):"..."})`),n+=`,${u(o)},${u(S)}`,l.pop();n+="]";break;default:if(!Z(r))throw new I("Cannot stringify arbitrary non-POJOs",l);if(Y(r).length>0)throw new I("Cannot stringify POJOs with symbolic keys",l);if(Object.getPrototypeOf(r)===null){n='["null"';for(const o in r)l.push(`.${o}`),n+=`,${_(o)},${u(r[o])}`,l.pop();n+="]"}else{n="{";let o=!1;for(const S in r)o&&(n+=","),o=!0,l.push(`.${S}`),n+=`${_(S)}:${u(r[S])}`,l.pop();n+="}"}}return s[c]=n,c}const O=u(e);return O<0?`${O}`:`[${s.join(",")}]`}function U(e){const t=typeof e;return t==="string"?_(e):e instanceof String?_(e.toString()):e===void 0?J.toString():e===0&&1/e<0?W.toString():t==="bigint"?`["BigInt","${e}"]`:String(e)}const g=Object.freeze(Object.defineProperty({__proto__:null,parse:ae,stringify:ve,uneval:ye,unflatten:ue},Symbol.toStringTag,{value:"Module"}));var y=[];for(var V=0;V<256;++V)y.push((V+256).toString(16).slice(1));function Oe(e,t=0){return(y[e[t+0]]+y[e[t+1]]+y[e[t+2]]+y[e[t+3]]+"-"+y[e[t+4]]+y[e[t+5]]+"-"+y[e[t+6]]+y[e[t+7]]+"-"+y[e[t+8]]+y[e[t+9]]+"-"+y[e[t+10]]+y[e[t+11]]+y[e[t+12]]+y[e[t+13]]+y[e[t+14]]+y[e[t+15]]).toLowerCase()}var D,_e=new Uint8Array(16);function Se(){if(!D&&(D=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!D))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return D(_e)}var je=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const F={randomUUID:je};function Ee(e,t,s){if(F.randomUUID&&!t&&!e)return F.randomUUID();e=e||{};var a=e.random||(e.rng||Se)();return a[6]=a[6]&15|64,a[8]=a[8]&63|128,Oe(a)}var G=(e=>(e.Person="Person",e.Location="Location",e.Task="Task",e.Shift="Shift",e.Skill="Skill",e))(G||{});function ze(e){return{uuid:Ee(),type:G.Person,...e}}function Re(e){return ee(e.name)}function Te(e){return new Date().getFullYear()-e.birthday.getFullYear()}var Ne=(e=>(e.NoPerson="NoPerson",e.NoLocation="NoLocation",e.NoTask="NoTask",e))(Ne||{});function ke(e){switch(e.type){case"NoPerson":return[e.applies_to,e.person];case"NoLocation":return[e.applies_to,e.location];case"NoTask":return[e.applies_to,e.task]}}function h(e,t){return ke(e).map(s=>s.uuid).includes(t.uuid)}var M={local:{},session:{}};function Ie(e){return e==="local"?localStorage:sessionStorage}function P(e,t,s){var a,d,l,$,u,O,r,c;s!=null&&s.onError&&console.warn("onError has been deprecated. Please use onWriteError instead");const n=(a=s==null?void 0:s.serializer)!=null?a:JSON,f=(d=s==null?void 0:s.storage)!=null?d:"local",i=(l=s==null?void 0:s.syncTabs)!=null?l:!0,m=(u=($=s==null?void 0:s.onWriteError)!=null?$:s==null?void 0:s.onError)!=null?u:b=>console.error(`Error when writing value from persisted store "${e}" to ${f}`,b),p=(O=s==null?void 0:s.onParseError)!=null?O:(b,w)=>console.error(`Error when parsing ${b?'"'+b+'"':"value"} from persisted store "${e}"`,w),o=(r=s==null?void 0:s.beforeRead)!=null?r:b=>b,S=(c=s==null?void 0:s.beforeWrite)!=null?c:b=>b,C=typeof window<"u"&&typeof document<"u",x=C?Ie(f):null;function L(b,w){const E=S(w);try{x==null||x.setItem(b,n.stringify(E))}catch(A){m(A)}}function K(){function b(v){try{return n.parse(v)}catch(N){p(v,N)}}const w=x==null?void 0:x.getItem(e);if(w==null)return t;const E=b(w);return E==null?t:o(E)}if(!M[f][e]){const b=K(),w=ce(b,v=>{if(C&&f=="local"&&i){const N=j=>{if(j.key===e&&j.newValue){let B;try{B=n.parse(j.newValue)}catch(X){p(j.newValue,X);return}const Q=o(B);v(Q)}};return window.addEventListener("storage",N),()=>window.removeEventListener("storage",N)}}),{subscribe:E,set:A}=w;M[f][e]={set(v){A(v),L(e,v)},update(v){return w.update(N=>{const j=v(N);return L(e,j),j})},reset(){this.set(t)},subscribe:E}}return M[f][e]}const Ue=P("skills",[],{serializer:g}),ge=P("employees",[],{serializer:g}),Ve=P("locations",[],{serializer:g}),Pe=P("tasks",[],{serializer:g}),q=P("constraints",[],{serializer:g}),Me=P("shifts",[],{serializer:g});function Ce(e){return re(q).filter(t=>h(t,e))}function Le(e){Pe.update(t=>t.map(s=>(s.people=s.people.filter(a=>a.uuid!==e.uuid),s))),q.update(t=>t.filter(s=>!h(s,e))),ge.update(t=>t.filter(s=>s.uuid!==e.uuid))}export{Ne as C,G as T,Me as a,ze as b,q as c,Ce as d,ge as e,ke as f,Re as g,Le as h,Te as i,Ve as l,Ue as s,Pe as t,Ee as v};
