var gt=Object.defineProperty;var _t=(r,t,e)=>t in r?gt(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var i=(r,t,e)=>_t(r,typeof t!="symbol"?t+"":t,e);import{s as Ct}from"../chunks/scheduler.CduG9CC3.js";import{S as Ft,i as Et}from"../chunks/index.BxX3sJHd.js";import{e as jt}from"../chunks/stores.N10PwQPi.js";import{d as f,r as j,w as F}from"../chunks/index.Eoah_KAy.js";import{P as vt}from"../chunks/person-avatar.55Jv0G9A.js";const Rt=r=>{const t=Object.entries(r),e=t.map(([s])=>s);return f(t.map(([,s])=>s),s=>Object.fromEntries(s.map((n,o)=>[e[o],n])))};j(void 0);class At{constructor(t,e){i(this,"component");i(this,"props");i(this,"eventHandlers",[]);i(this,"children",[]);this.component=t,this.props=e}on(t,e){return this.eventHandlers.push([t,e]),this}slot(...t){return this.children=t,this}}function Ht(r,t){return new At(r,t)}class X{constructor({header:t,footer:e,height:s,plugins:n}){i(this,"header");i(this,"footer");i(this,"height");i(this,"plugins");this.header=t,this.footer=e,this.height=s,this.plugins=n}isFlat(){return"__flat"in this}isData(){return"__data"in this}isDisplay(){return"__display"in this}isGroup(){return"__group"in this}}class Y extends X{constructor({header:e,footer:s,plugins:n,id:o}){super({header:e,footer:s,plugins:n,height:1});i(this,"__flat",!0);i(this,"id");this.id=o??String(e)}}class It extends Y{constructor({header:e,footer:s,plugins:n,cell:o,accessor:a,id:c}){super({header:e,footer:s,plugins:n,id:"Initialization not complete"});i(this,"__data",!0);i(this,"cell");i(this,"accessorKey");i(this,"accessorFn");if(this.cell=o,a instanceof Function?this.accessorFn=a:this.accessorKey=a,c===void 0&&this.accessorKey===void 0&&e===void 0)throw new Error("A column id, string accessor, or header is required");const u=typeof this.accessorKey=="string"?this.accessorKey:null;this.id=c??u??String(e)}getValue(e){if(this.accessorFn!==void 0)return this.accessorFn(e);if(this.accessorKey!==void 0)return e[this.accessorKey]}}class St extends Y{constructor({header:e,footer:s,plugins:n,id:o,cell:a,data:c}){super({header:e,footer:s,plugins:n,id:o});i(this,"__display",!0);i(this,"cell");i(this,"data");this.cell=a,this.data=c}}class kt extends X{constructor({header:e,footer:s,columns:n,plugins:o}){const a=Math.max(...n.map(c=>c.height))+1;super({header:e,footer:s,height:a,plugins:o});i(this,"__group",!0);i(this,"columns");i(this,"ids");this.columns=n,this.ids=Z(n)}}const Z=r=>r.flatMap(t=>t.isFlat()?[t.id]:t.isGroup()?t.ids:[]),tt=r=>r.flatMap(t=>t.isFlat()?[t]:t.isGroup()?tt(t.columns):[]),Dt=r=>{const t=new Map;return r.forEach(e=>{t.set(e,(t.get(e)??0)+1)}),t},Ot=r=>Array.from(Dt(r).entries()).filter(([,t])=>t!==1).map(([t])=>t),Tt=r=>Object.entries(r).map(([t,e])=>`${t}:${e}`).join(";"),xt=(r,t)=>r.style===void 0&&t.style===void 0?{...r,...t}:{...r,...t,style:{...typeof r.style=="object"?r.style:{},...typeof t.style=="object"?t.style:{}}},v=r=>r.style===void 0||typeof r.style!="object"?r:{...r,style:Tt(r.style)};class R{constructor({id:t}){i(this,"id");i(this,"attrsForName",{});i(this,"propsForName",{});i(this,"state");this.id=t}attrs(){return f(Object.values(this.attrsForName),t=>{let e={};return t.forEach(s=>{e=xt(e,s)}),v(e)})}props(){return Rt(this.propsForName)}injectState(t){this.state=t}applyHook(t,e){e.props!==void 0&&(this.propsForName[t]=e.props),e.attrs!==void 0&&(this.attrsForName[t]=e.attrs)}}class et extends R{constructor({id:e,row:s}){super({id:e});i(this,"row");this.row=s}attrs(){return f(super.attrs(),e=>({...e,role:"cell"}))}rowColId(){return`${this.row.id}:${this.column.id}`}dataRowColId(){if(this.row.isData())return`${this.row.dataId}:${this.column.id}`}isData(){return"__data"in this}isDisplay(){return"__display"in this}}class z extends et{constructor({row:e,column:s,label:n,value:o}){super({id:s.id,row:e});i(this,"__data",!0);i(this,"column");i(this,"label");i(this,"value");this.column=s,this.label=n,this.value=o}render(){if(this.label===void 0)return`${this.value}`;if(this.state===void 0)throw new Error("Missing `state` reference");return this.label(this,this.state)}clone(){return new z({row:this.row,column:this.column,label:this.label,value:this.value})}}class P extends et{constructor({row:e,column:s,label:n}){super({id:s.id,row:e});i(this,"__display",!0);i(this,"column");i(this,"label");this.column=s,this.label=n}render(){if(this.state===void 0)throw new Error("Missing `state` reference");return this.label(this,this.state)}clone(){return new P({row:this.row,column:this.column,label:this.label})}}const C=r=>r!==void 0;class Kt extends R{constructor({id:e,cells:s,cellForId:n,depth:o=0,parentRow:a}){super({id:e});i(this,"cells");i(this,"cellForId");i(this,"depth");i(this,"parentRow");i(this,"subRows");this.cells=s,this.cellForId=n,this.depth=o,this.parentRow=a}attrs(){return f(super.attrs(),e=>({...e,role:"row"}))}isData(){return"__data"in this}isDisplay(){return"__display"in this}}class N extends Kt{constructor({id:e,dataId:s,original:n,cells:o,cellForId:a,depth:c=0,parentRow:u}){super({id:e,cells:o,cellForId:a,depth:c,parentRow:u});i(this,"__data",!0);i(this,"dataId");i(this,"original");this.dataId=s,this.original=n}clone({includeCells:e=!1,includeSubRows:s=!1}={}){var o;const n=new N({id:this.id,dataId:this.dataId,cellForId:this.cellForId,cells:this.cells,original:this.original,depth:this.depth});if(e){const a=Object.fromEntries(Object.entries(n.cellForId).map(([u,y])=>{const g=y.clone();return g.row=n,[u,g]})),c=n.cells.map(({id:u})=>a[u]);n.cellForId=a,n.cells=c}if(s){const a=(o=this.subRows)==null?void 0:o.map(c=>c.clone({includeCells:e,includeSubRows:s}));n.subRows=a}else n.subRows=this.subRows;return n}}const Bt=(r,t,{rowDataId:e}={})=>{const s=r.map((n,o)=>{const a=o.toString();return new N({id:a,dataId:e!==void 0?e(n,o):a,original:n,cells:[],cellForId:{}})});return r.forEach((n,o)=>{const a=t.map(c=>{if(c.isData()){const u=c,y=u.getValue(n);return new z({row:s[o],column:u,label:c.cell,value:y})}if(c.isDisplay()){const u=c;return new P({row:s[o],column:u,label:c.cell})}throw new Error("Unrecognized `FlatColumn` implementation")});s[o].cells=a,t.forEach((c,u)=>{s[o].cellForId[c.id]=a[u]})}),s},Gt=(r,t)=>{const e=r.map(s=>{const n=s.clone();return n.cells=[],n.cellForId={},n});return r.length===0||t.length===0?r:(r.forEach((s,n)=>{const o=s.cells.map(c=>{const u=c.clone();return u.row=e[n],u}),a=t.map(c=>o.find(u=>u.id===c)).filter(C);e[n].cells=a,o.forEach(c=>{e[n].cellForId[c.id]=c})}),e)},st=" ";class rt extends R{constructor({id:e,label:s,colspan:n,colstart:o}){super({id:e});i(this,"label");i(this,"colspan");i(this,"colstart");this.label=s,this.colspan=n,this.colstart=o}render(){if(this.label instanceof Function){if(this.state===void 0)throw new Error("Missing `state` reference");return this.label(this,this.state)}return this.label}attrs(){return f(super.attrs(),e=>({...e,role:"columnheader",colspan:this.colspan}))}isFlat(){return"__flat"in this}isData(){return"__data"in this}isFlatDisplay(){return"__flat"in this&&"__display"in this}isGroup(){return"__group"in this}isGroupDisplay(){return"__group"in this&&"__display"in this}}class A extends rt{constructor({id:e,label:s,colstart:n}){super({id:e,label:s,colspan:1,colstart:n});i(this,"__flat",!0)}clone(){return new A({id:this.id,label:this.label,colstart:this.colstart})}}class V extends A{constructor({id:e,label:s,accessorKey:n,accessorFn:o,colstart:a}){super({id:e,label:s,colstart:a});i(this,"__data",!0);i(this,"accessorKey");i(this,"accessorFn");this.accessorKey=n,this.accessorFn=o}clone(){return new V({id:this.id,label:this.label,accessorFn:this.accessorFn,accessorKey:this.accessorKey,colstart:this.colstart})}}class H extends A{constructor({id:e,label:s=st,colstart:n}){super({id:e,label:s,colstart:n});i(this,"__display",!0)}clone(){return new H({id:this.id,label:this.label,colstart:this.colstart})}}class I extends rt{constructor({label:e,ids:s,allIds:n,colspan:o,colstart:a}){super({id:`[${s.join(",")}]`,label:e,colspan:o,colstart:a});i(this,"__group",!0);i(this,"ids");i(this,"allId");i(this,"allIds");this.ids=s,this.allId=`[${n.join(",")}]`,this.allIds=n}setIds(e){this.ids=e,this.id=`[${this.ids.join(",")}]`}pushId(e){this.ids=[...this.ids,e],this.id=`[${this.ids.join(",")}]`}clone(){return new I({label:this.label,ids:this.ids,allIds:this.allIds,colspan:this.colspan,colstart:this.colstart})}}class q extends I{constructor({label:e=st,ids:s,allIds:n,colspan:o=1,colstart:a}){super({label:e,ids:s,allIds:n,colspan:o,colstart:a});i(this,"__display",!0)}clone(){return new q({label:this.label,ids:this.ids,allIds:this.allIds,colspan:this.colspan,colstart:this.colstart})}}const Mt=r=>r.reduce((t,e)=>t+e,0),nt=(r,t)=>{const e=[];for(let s=0;s<t;s++)e.push(Array(r).fill(null));return e},W=r=>{const t=r.length;if(t===0)return r;const e=r[0].length,s=nt(t,e);for(let n=0;n<e;n++)for(let o=0;o<t;o++)s[n][o]=r[o][n];return s};class U extends R{constructor({id:e,cells:s}){super({id:e});i(this,"cells");this.cells=s}attrs(){return f(super.attrs(),e=>({...e,role:"row"}))}clone(){return new U({id:this.id,cells:this.cells})}}const $t=(r,t=[])=>{const e=zt(r);let s=W(e);return s=Pt(s,t),Nt(s),Vt(W(s))},zt=r=>{const t=Mt(r.map(o=>o.isGroup()?o.ids.length:1)),e=Math.max(...r.map(o=>o.height)),s=nt(t,e);let n=0;return r.forEach(o=>{const a=e-o.height;ot(s,o,a,n),n+=o.isGroup()?o.ids.length:1}),s.map((o,a)=>o.map((c,u)=>{var g;if(c!==null)return c;if(a===e-1)return new H({id:u.toString(),colstart:u});const y=((g=s[e-1][u])==null?void 0:g.id)??u.toString();return new q({ids:[],allIds:[y],colstart:u})}))},ot=(r,t,e,s)=>{if(t.isData()){r[r.length-1][s]=new V({label:t.header,accessorFn:t.accessorFn,accessorKey:t.accessorKey,id:t.id,colstart:s});return}if(t.isDisplay()){r[r.length-1][s]=new H({id:t.id,label:t.header,colstart:s});return}if(t.isGroup()){for(let o=0;o<t.ids.length;o++)r[e][s+o]=new I({label:t.header,colspan:1,allIds:t.ids,ids:[],colstart:s});let n=0;t.columns.forEach(o=>{ot(r,o,e+1,s+n),n+=o.isGroup()?o.ids.length:1});return}},Pt=(r,t)=>{if(t.length===0)return r;const e=[];return t.forEach((s,n)=>{const o=r.find(a=>{const c=a[a.length-1];if(!c.isFlat())throw new Error("The last element of each column must be a `FlatHeaderCell`");return c.id===s});o!==void 0&&e.push(o.map(a=>{const c=a.clone();return c.colstart=n,c}))}),e},Nt=r=>{r.forEach(t=>{const e=t[t.length-1];if(!e.isFlat())throw new Error("The last element of each column must be a `FlatHeaderCell`");t.forEach(s=>{s.isGroup()&&s.pushId(e.id)})})},Vt=r=>r.map((t,e)=>new U({id:e.toString(),cells:qt(t)})),qt=r=>{if(r.length===0)return r;const t=[];let e=0,s=1;for(;e<r.length;){const n=r[e].clone();if(!n.isGroup()){t.push(n),e++;continue}s=e+1;const o=[...n.ids];for(;s<r.length;){const a=r[s];if(!a.isGroup()||n.allId!==a.allId)break;o.push(...a.ids),s++}n.setIds(o),n.colspan=s-e,t.push(n),e=s}return t},Ut=(r,t,{rowDataId:e}={})=>{const{data:s,plugins:n}=r,o=tt(t),a=j(o),c=f([s,a],([l,d])=>Bt(l,d,{rowDataId:e})),u=F([]),y=F(),g=F([]),S=F([]),k=F({role:"table"}),D=F({}),O=F({role:"rowgroup"}),it={data:s,columns:t,flatColumns:o,tableAttrs:k,tableHeadAttrs:D,tableBodyAttrs:O,visibleColumns:u,headerRows:y,originalRows:c,rows:g,pageRows:S},w=Object.fromEntries(Object.entries(n).map(([l,d])=>{const h=Object.fromEntries(o.map(p=>{var m;const b=(m=p.plugins)==null?void 0:m[l];if(b!==void 0)return[p.id,b]}).filter(C));return[l,d({pluginName:l,tableState:it,columnOptions:h})]})),J=Object.fromEntries(Object.entries(w).map(([l,d])=>[l,d.pluginState])),E={data:s,columns:t,flatColumns:o,tableAttrs:k,tableHeadAttrs:D,tableBodyAttrs:O,visibleColumns:u,headerRows:y,originalRows:c,rows:g,pageRows:S,pluginStates:J},lt=Object.values(w).map(l=>l.deriveTableAttrs).filter(C);let T=j({role:"table"});lt.forEach(l=>{T=l(T)});const at=f(T,l=>{const d=v(l);return k.set(d),d}),ct=Object.values(w).map(l=>l.deriveTableBodyAttrs).filter(C);let x=j({});ct.forEach(l=>{x=l(x)});const dt=f(x,l=>{const d=v(l);return D.set(d),d}),ut=Object.values(w).map(l=>l.deriveTableBodyAttrs).filter(C);let K=j({role:"rowgroup"});ut.forEach(l=>{K=l(K)});const ht=f(K,l=>{const d=v(l);return O.set(d),d}),pt=Object.values(w).map(l=>l.deriveFlatColumns).filter(C);let B=a;pt.forEach(l=>{B=l(B)});const G=f(B,l=>(u.set(l),l)),ft=f([c,G],([l,d])=>Gt(l,d.map(h=>h.id))),bt=Object.values(w).map(l=>l.deriveRows).filter(C);let M=ft;bt.forEach(l=>{M=l(M)});const L=f(M,l=>(l.forEach(d=>{d.injectState(E),d.cells.forEach(h=>{h.injectState(E)})}),Object.entries(w).forEach(([d,h])=>{l.forEach(p=>{var b;((b=h.hooks)==null?void 0:b["tbody.tr"])!==void 0&&p.applyHook(d,h.hooks["tbody.tr"](p)),p.cells.forEach(m=>{var _;((_=h.hooks)==null?void 0:_["tbody.tr.td"])!==void 0&&m.applyHook(d,h.hooks["tbody.tr.td"](m))})})}),g.set(l),l)),mt=Object.values(w).map(l=>l.derivePageRows).filter(C);let $=L;mt.forEach(l=>{$=l($)});const wt=f($,l=>(l.forEach(d=>{d.injectState(E),d.cells.forEach(h=>{h.injectState(E)})}),Object.entries(w).forEach(([d,h])=>{l.forEach(p=>{var b;((b=h.hooks)==null?void 0:b["tbody.tr"])!==void 0&&p.applyHook(d,h.hooks["tbody.tr"](p)),p.cells.forEach(m=>{var _;((_=h.hooks)==null?void 0:_["tbody.tr.td"])!==void 0&&m.applyHook(d,h.hooks["tbody.tr.td"](m))})})}),S.set(l),l)),yt=f(G,l=>{const d=$t(t,l.map(h=>h.id));return d.forEach(h=>{h.injectState(E),h.cells.forEach(p=>{p.injectState(E)})}),Object.entries(w).forEach(([h,p])=>{d.forEach(b=>{var m;((m=p.hooks)==null?void 0:m["thead.tr"])!==void 0&&b.applyHook(h,p.hooks["thead.tr"](b)),b.cells.forEach(_=>{var Q;((Q=p.hooks)==null?void 0:Q["thead.tr.th"])!==void 0&&_.applyHook(h,p.hooks["thead.tr.th"](_))})})}),y.set(d),d});return{tableAttrs:at,tableHeadAttrs:dt,tableBodyAttrs:ht,visibleColumns:G,flatColumns:o,headerRows:yt,originalRows:c,rows:L,pageRows:wt,pluginStates:J}};class Jt{constructor(t,e){i(this,"data");i(this,"plugins");this.data=t,this.plugins=e}createColumns(t){const e=Z(t),s=Ot(e);if(s.length!==0)throw new Error(`Duplicate column ids not allowed: "${s.join('", "')}"`);return t}column(t){return new It(t)}group(t){return new kt(t)}display(t){return new St(t)}createViewModel(t,e){return Ut(this,t,e)}}const Lt=(r,t={})=>new Jt(r,t);function Qt(r){const t=Lt(jt);return t.createColumns([t.column({accessor:e=>e,header:"Name",cell:e=>Ht(vt,{person:e.value})}),t.column({accessor:"name",header:"Name"}),t.column({accessor:"job_title",header:"Job Title"})]),[]}class se extends Ft{constructor(t){super(),Et(this,t,Qt,null,Ct,{})}}export{se as component};
